{% block content %}
{% load static %}

<script>
    var CLASSE_CSS_SELECIONADO = 'selecionado';
    var ITEM_TEMPLATE = '';
    var CARREGANDO = '';
    var tipoAtivo = '{{ tipo_ativo.id }}';
    var containerItens = null;

    function aplicaItens(itens) {
        var html = '';
        for(item of itens) {
            var campos = item.fields;
            html += ITEM_TEMPLATE.format(
                campos.imagem,
                campos.nome,
                campos.descricao,
                campos.preco
            );
        }
        containerItens.html(html);
    }

    function trocaTipo(tipoSelecionado) {
        $('#seletor-tipo-' + tipoAtivo).removeClass(CLASSE_CSS_SELECIONADO);
        $('#seletor-tipo-' + tipoSelecionado).addClass(CLASSE_CSS_SELECIONADO);
        tipoAtivo = tipoSelecionado;
        containerItens.html('Carregando...');
        $.ajax({
            url: '/cardapio/categoria?tipo=' + tipoSelecionado,
            method: 'GET'
        }).done(function(response) {
            aplicaItens(JSON.parse(response));
        });
    }
    $(document).ready(function() {
        $.ajax({
            url: "{% static 'html/cardapio_item.html' %}",
            method: 'GET'
        }).done(function(response) {
            ITEM_TEMPLATE = response;
            containerItens = $('#cardapio-items');
            CARREGANDO = containerItens.html();
            trocaTipo(tipoAtivo);
        });
    });
</script>
<div id="texto">
    <p>Selecione os itens do pedido</p>
</div>

<div class="opcoes-cardapio">
    <ul class="tipos">
        {% for tipo in tipos%}
        <li class="tipositem">
            <a href="javascript://" onclick="trocaTipo('{{tipo.id}}');" id="seletor-tipo-{{tipo.id}}">
                {{ tipo.tipo }}
            </a>
        </li>
        {% endfor %}
    </ul>
</div>

<div class="container-pizzas">
    <section class="grid grid-3-columns" id="cardapio-items"></section>
</div>
{% endblock%}